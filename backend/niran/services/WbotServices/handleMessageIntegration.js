const a796_0x53725a=a796_0x34d5;(function(_0x197a0a,_0x53a0be){const _0x1a91f1=a796_0x34d5,_0x30c1d2=_0x197a0a();while(!![]){try{const _0x320c69=-parseInt(_0x1a91f1(0x1fa))/0x1+-parseInt(_0x1a91f1(0x221))/0x2*(parseInt(_0x1a91f1(0x1a7))/0x3)+-parseInt(_0x1a91f1(0x1d9))/0x4+-parseInt(_0x1a91f1(0x214))/0x5+parseInt(_0x1a91f1(0x20f))/0x6*(-parseInt(_0x1a91f1(0x1ff))/0x7)+-parseInt(_0x1a91f1(0x23f))/0x8*(parseInt(_0x1a91f1(0x150))/0x9)+parseInt(_0x1a91f1(0x16e))/0xa;if(_0x320c69===_0x53a0be)break;else _0x30c1d2['push'](_0x30c1d2['shift']());}catch(_0x1ff12a){_0x30c1d2['push'](_0x30c1d2['shift']());}}}(a796_0x50a7,0x3682d));const a796_0x5538cb=(function(){const _0x50109f=a796_0x34d5,_0x1514f1={};_0x1514f1[_0x50109f(0x142)]=_0x50109f(0x116),_0x1514f1[_0x50109f(0x22f)]=_0x50109f(0x180),_0x1514f1[_0x50109f(0xfe)]=_0x50109f(0x114),_0x1514f1[_0x50109f(0x1eb)]=_0x50109f(0x1a0);const _0x330251=_0x1514f1;let _0x50fa6=!![];return function(_0x1d1e4a,_0x385691){const _0x3e89db=_0x50109f,_0x482fe9={};_0x482fe9[_0x3e89db(0x1f5)]=_0x330251[_0x3e89db(0x142)],_0x482fe9['CTraC']=_0x330251['QXVcq'],_0x482fe9[_0x3e89db(0x22c)]=function(_0x42c8c6,_0x596728){return _0x42c8c6!==_0x596728;},_0x482fe9[_0x3e89db(0x176)]=_0x3e89db(0x131);const _0x179e85=_0x482fe9;if(_0x330251[_0x3e89db(0xfe)]!==_0x330251[_0x3e89db(0x1eb)]){const _0x2307d4=_0x50fa6?function(){const _0x532b46=_0x3e89db,_0x30df96={};_0x30df96[_0x532b46(0x12a)]=_0x179e85[_0x532b46(0x1f5)];const _0x2387d4=_0x30df96;if(_0x532b46(0x129)===_0x179e85[_0x532b46(0x15d)]){const _0x35f86=_0xdcdceb[_0x532b46(0x185)];return!_0x35f86[_0x532b46(0x125)](_0x2387d4[_0x532b46(0x12a)]);}else{if(_0x385691){if(_0x179e85[_0x532b46(0x22c)](_0x179e85['cUcso'],_0x179e85[_0x532b46(0x176)]))return!![];else{const _0x42c770=_0x385691[_0x532b46(0x226)](_0x1d1e4a,arguments);return _0x385691=null,_0x42c770;}}}}:function(){};return _0x50fa6=![],_0x2307d4;}else return _0x3bb3eb['replace'](/queueId:\s*\d+/g,'')['replace'](/tagId:\s*\d+/g,'')[_0x3e89db(0x111)](/status:\s*(open|pending|closed)/g,'')[_0x3e89db(0x111)](/userId:\s*\d+/g,'')[_0x3e89db(0x1cd)]();};}()),a796_0x57e04b=a796_0x5538cb(this,function(){const _0x366d39=a796_0x34d5,_0x29f240={};_0x29f240['FXhZl']=_0x366d39(0x1b3);const _0x44cea0=_0x29f240;return a796_0x57e04b[_0x366d39(0x1b6)]()[_0x366d39(0x1ed)](_0x366d39(0x1b3))['toString']()[_0x366d39(0x1be)](a796_0x57e04b)[_0x366d39(0x1ed)](_0x44cea0['FXhZl']);});a796_0x57e04b();const a796_0x6422cd=(function(){const _0x3a7cc4=a796_0x34d5,_0x3aca51={};_0x3aca51[_0x3a7cc4(0x17a)]=_0x3a7cc4(0x16a),_0x3aca51[_0x3a7cc4(0x103)]=_0x3a7cc4(0x141),_0x3aca51[_0x3a7cc4(0x157)]=function(_0x2bc664,_0x51b53d){return _0x2bc664===_0x51b53d;},_0x3aca51[_0x3a7cc4(0x1a6)]=_0x3a7cc4(0x144),_0x3aca51[_0x3a7cc4(0x210)]='glrTx',_0x3aca51['qfowb']=function(_0x572623,_0x41d4e0){return _0x572623!==_0x41d4e0;},_0x3aca51[_0x3a7cc4(0x136)]='guyOk',_0x3aca51[_0x3a7cc4(0x162)]='bYDER',_0x3aca51[_0x3a7cc4(0x166)]=function(_0x2b7779,_0x51a464){return _0x2b7779!==_0x51a464;},_0x3aca51[_0x3a7cc4(0x174)]=_0x3a7cc4(0x1c1);const _0x2e4672=_0x3aca51;let _0x5cf2ae=!![];return function(_0x5162ef,_0x415c5b){const _0x9bfcd5=_0x3a7cc4;if(_0x2e4672['ZjYYC'](_0x9bfcd5(0x1c1),_0x2e4672[_0x9bfcd5(0x174)])){_0x52cd03[_0x9bfcd5(0x1dd)](_0x2e4672[_0x9bfcd5(0x17a)],_0x3b4917);return;}else{const _0x4d8482=_0x5cf2ae?function(){const _0x57a3f3=_0x9bfcd5,_0x296c58={};_0x296c58[_0x57a3f3(0x15a)]=_0x2e4672[_0x57a3f3(0x103)];const _0x83f515=_0x296c58;if(_0x2e4672[_0x57a3f3(0x157)](_0x2e4672[_0x57a3f3(0x1a6)],_0x2e4672[_0x57a3f3(0x210)]))_0xe2c9a1[_0x57a3f3(0x1dd)](_0x83f515[_0x57a3f3(0x15a)],_0xcd9b92);else{if(_0x415c5b){if(_0x2e4672[_0x57a3f3(0x1d8)](_0x2e4672[_0x57a3f3(0x136)],_0x2e4672[_0x57a3f3(0x162)])){const _0x4f0433=_0x415c5b[_0x57a3f3(0x226)](_0x5162ef,arguments);return _0x415c5b=null,_0x4f0433;}else{const _0x58bdca={};return _0x58bdca[_0x57a3f3(0x10b)]=_0x63fbcc,_0x4350a3&&_0x4e44ea[_0x57a3f3(0x13f)]?_0x4c3ff4:_0x58bdca;}}}}:function(){};return _0x5cf2ae=![],_0x4d8482;}};}());(function(){const _0x217059=a796_0x34d5,_0xb2d539={'VPpyy':_0x217059(0xfc),'LSmXe':function(_0x3d040d,_0xc1f2d0){return _0x3d040d(_0xc1f2d0);},'eytcE':function(_0x319c9c,_0x34a461){return _0x319c9c+_0x34a461;},'UhEhl':_0x217059(0x143),'oAJCi':_0x217059(0x122),'ljagw':function(_0x586bd8,_0xcbd9c4){return _0x586bd8===_0xcbd9c4;},'NpsRt':_0x217059(0x237),'OuISP':'function\x20*\x5c(\x20*\x5c)','YDIAB':_0x217059(0x20e),'AlObZ':function(_0x16e0ca,_0x31ac75){return _0x16e0ca+_0x31ac75;},'eCRaP':_0x217059(0x110),'mbIxU':function(_0xc623b3,_0x403657){return _0xc623b3+_0x403657;},'tMVRf':_0x217059(0x1d7),'TUpGf':function(_0x5ddeb2,_0x404ffe){return _0x5ddeb2!==_0x404ffe;},'TqeKh':_0x217059(0x20a),'wqdqW':_0x217059(0x239),'RayZR':_0x217059(0x212),'uOpYv':_0x217059(0x1e3),'UsAty':function(_0x3c7560,_0x1d6b61,_0x34e759){return _0x3c7560(_0x1d6b61,_0x34e759);}};_0xb2d539[_0x217059(0xff)](a796_0x6422cd,this,function(){const _0x29fb03=_0x217059,_0x2c097c={'yxqdC':function(_0x418858,_0x17c810){const _0x5b4dea=a796_0x34d5;return _0xb2d539[_0x5b4dea(0xed)](_0x418858,_0x17c810);},'HJPBG':function(_0x53f16d,_0x4610ad){const _0x119a5e=a796_0x34d5;return _0xb2d539[_0x119a5e(0x17b)](_0x53f16d,_0x4610ad);},'BAWHZ':_0xb2d539[_0x29fb03(0x13b)],'CpLfz':_0xb2d539[_0x29fb03(0x10a)]};if(_0xb2d539[_0x29fb03(0x1f6)](_0x29fb03(0x237),_0xb2d539[_0x29fb03(0x16b)])){const _0x36aa53=new RegExp(_0xb2d539[_0x29fb03(0x179)]),_0x3c1181=new RegExp(_0x29fb03(0x100),'i'),_0xe9e0bf=_0xb2d539[_0x29fb03(0xed)](a796_0x333be2,_0xb2d539[_0x29fb03(0x225)]);if(!_0x36aa53['test'](_0xb2d539['AlObZ'](_0xe9e0bf,_0xb2d539['eCRaP']))||!_0x3c1181[_0x29fb03(0xec)](_0xb2d539['mbIxU'](_0xe9e0bf,_0xb2d539[_0x29fb03(0x1f9)]))){if(_0xb2d539[_0x29fb03(0x20d)](_0xb2d539[_0x29fb03(0x14d)],_0xb2d539['wqdqW']))_0xb2d539[_0x29fb03(0xed)](_0xe9e0bf,'0');else{const _0x45f184=_0x58f765?function(){const _0x1344aa=_0x29fb03;if(_0x5c4daf){const _0x43eedb=_0x41552c[_0x1344aa(0x226)](_0x15ebf9,arguments);return _0x503129=null,_0x43eedb;}}:function(){};return _0x38acae=![],_0x45f184;}}else{if(_0xb2d539['RayZR']===_0xb2d539[_0x29fb03(0x1a5)])return _0xb2d539['VPpyy'];else a796_0x333be2();}}else{let _0x62ae57;try{_0x62ae57=_0x2c097c[_0x29fb03(0x1d0)](_0x39a513,_0x2c097c[_0x29fb03(0x1ec)](_0x2c097c[_0x29fb03(0x132)]+_0x2c097c['CpLfz'],');'))();}catch(_0xdc519c){_0x62ae57=_0x2e3e8f;}return _0x62ae57;}})();}());const a796_0x458400=(function(){const _0x2c9cb0=a796_0x34d5,_0x49acee={};_0x49acee[_0x2c9cb0(0x197)]=function(_0x108afb,_0x173ba8){return _0x108afb===_0x173ba8;},_0x49acee[_0x2c9cb0(0x22e)]=_0x2c9cb0(0x18e),_0x49acee[_0x2c9cb0(0x101)]=function(_0x54fefb,_0x1338ad){return _0x54fefb!==_0x1338ad;},_0x49acee[_0x2c9cb0(0x21c)]=_0x2c9cb0(0x182),_0x49acee[_0x2c9cb0(0x202)]=_0x2c9cb0(0x1b7),_0x49acee[_0x2c9cb0(0x163)]=function(_0x15e826,_0x12f516){return _0x15e826===_0x12f516;},_0x49acee[_0x2c9cb0(0x1fc)]=_0x2c9cb0(0x23a);const _0x26c0b8=_0x49acee;let _0x4abb6f=!![];return function(_0x144afc,_0x145da7){const _0x585e16=_0x2c9cb0;if(_0x26c0b8[_0x585e16(0x163)](_0x26c0b8[_0x585e16(0x1fc)],_0x26c0b8[_0x585e16(0x1fc)])){const _0x3486d4=_0x4abb6f?function(){const _0x5535a3=_0x585e16;if(_0x26c0b8[_0x5535a3(0x197)](_0x26c0b8[_0x5535a3(0x22e)],_0x26c0b8['aVxIY'])){if(_0x145da7){if(_0x26c0b8[_0x5535a3(0x101)](_0x26c0b8[_0x5535a3(0x21c)],_0x5535a3(0x140))){const _0x581d5c=_0x145da7['apply'](_0x144afc,arguments);return _0x145da7=null,_0x581d5c;}else return _0x1d2f0a;}}else{if(_0x470f5b){const _0x13560c=_0x13cf3a[_0x5535a3(0x226)](_0x730498,arguments);return _0x833c58=null,_0x13560c;}}}:function(){};return _0x4abb6f=![],_0x3486d4;}else _0x3fb99b[_0x585e16(0x1dd)](_0x26c0b8['pMUNp'],_0x543df4);};}()),a796_0x56c0c0=a796_0x458400(this,function(){const _0xdd0fbf=a796_0x34d5,_0x2d527d={};_0x2d527d['CElOy']=_0xdd0fbf(0x1ab),_0x2d527d[_0xdd0fbf(0x17f)]=function(_0x128faa,_0x59ec5b){return _0x128faa+_0x59ec5b;},_0x2d527d[_0xdd0fbf(0x1f2)]=_0xdd0fbf(0x143),_0x2d527d[_0xdd0fbf(0x113)]=_0xdd0fbf(0x122),_0x2d527d[_0xdd0fbf(0x12c)]=function(_0x4c99b5,_0x31d69d){return _0x4c99b5===_0x31d69d;},_0x2d527d[_0xdd0fbf(0x1b5)]=_0xdd0fbf(0x118),_0x2d527d[_0xdd0fbf(0x233)]=_0xdd0fbf(0x134),_0x2d527d[_0xdd0fbf(0x17c)]='warn',_0x2d527d['BpqhX']='info',_0x2d527d[_0xdd0fbf(0x23e)]=_0xdd0fbf(0x1dd),_0x2d527d[_0xdd0fbf(0x11f)]=_0xdd0fbf(0x1d5),_0x2d527d[_0xdd0fbf(0x159)]=_0xdd0fbf(0xf8),_0x2d527d[_0xdd0fbf(0x1a3)]=function(_0x396d74,_0x2a0c70){return _0x396d74<_0x2a0c70;},_0x2d527d[_0xdd0fbf(0x133)]=_0xdd0fbf(0x1c6),_0x2d527d['zsnjf']=_0xdd0fbf(0x155);const _0x10163d=_0x2d527d,_0x1ca248=function(){const _0xcef91f=_0xdd0fbf;if(_0x10163d[_0xcef91f(0x15f)]!==_0x10163d[_0xcef91f(0x15f)])return![];else{let _0x2ac768;try{if(_0xcef91f(0x1ce)!==_0xcef91f(0x1ea))_0x2ac768=Function(_0x10163d[_0xcef91f(0x17f)](_0x10163d[_0xcef91f(0x1f2)]+_0x10163d['hPied'],');'))();else{_0x569e64[_0xcef91f(0x1dd)](_0xcef91f(0x20c));return;}}catch(_0x3790b5){if(_0x10163d[_0xcef91f(0x12c)](_0x10163d[_0xcef91f(0x1b5)],_0x10163d[_0xcef91f(0x1b5)]))_0x2ac768=window;else{const _0x2baac3=_0x550f3b[_0xcef91f(0x1be)]['prototype'][_0xcef91f(0x161)](_0x43c977),_0x261395=_0x1c20e9[_0x45842e],_0x4f283e=_0x57ed41[_0x261395]||_0x2baac3;_0x2baac3[_0xcef91f(0x222)]=_0x3f620f[_0xcef91f(0x161)](_0x3b2122),_0x2baac3[_0xcef91f(0x1b6)]=_0x4f283e[_0xcef91f(0x1b6)][_0xcef91f(0x161)](_0x4f283e),_0xafe00b[_0x261395]=_0x2baac3;}}return _0x2ac768;}},_0xf512e2=_0x1ca248(),_0x2531b0=_0xf512e2['console']=_0xf512e2['console']||{},_0x5aeeff=[_0x10163d['WbzpC'],_0x10163d[_0xdd0fbf(0x17c)],_0x10163d[_0xdd0fbf(0x164)],_0x10163d['PIdvR'],_0x10163d[_0xdd0fbf(0x11f)],_0xdd0fbf(0x119),_0x10163d['iMkll']];for(let _0x1c52b3=0x0;_0x10163d['unKzL'](_0x1c52b3,_0x5aeeff['length']);_0x1c52b3++){if(_0x10163d[_0xdd0fbf(0x12c)](_0x10163d[_0xdd0fbf(0x133)],_0x10163d['zsnjf'])){if(_0x56cd5d){const _0x83b539=_0x58ef92[_0xdd0fbf(0x226)](_0xc85a78,arguments);return _0x246140=null,_0x83b539;}}else{const _0x30c096=a796_0x458400[_0xdd0fbf(0x1be)]['prototype'][_0xdd0fbf(0x161)](a796_0x458400),_0x57917d=_0x5aeeff[_0x1c52b3],_0x349b8b=_0x2531b0[_0x57917d]||_0x30c096;_0x30c096[_0xdd0fbf(0x222)]=a796_0x458400[_0xdd0fbf(0x161)](a796_0x458400),_0x30c096[_0xdd0fbf(0x1b6)]=_0x349b8b['toString'][_0xdd0fbf(0x161)](_0x349b8b),_0x2531b0[_0x57917d]=_0x30c096;}}});a796_0x56c0c0();'use strict';var __importDefault=this&&this[a796_0x53725a(0x14f)]||function(_0x3ad79d){const _0x17f886=a796_0x53725a;return _0x3ad79d&&_0x3ad79d[_0x17f886(0x13f)]?_0x3ad79d:{'default':_0x3ad79d};};function a796_0x50a7(){const _0x49a60b=['\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','OserI','status','XkkPw','filter','handleMessageIntegration','DIJaH','XMQOv','eakrw','XlPqp','oAJCi','default','role','../TicketServices/UpdateTicketService','CxHah','FQyQF','chain','replace','BFraY','hPied','kxCtc','krXQk','Atendimento\x20finalizado','jjVuG','BzapW','table','base64','NwwEW','BcRbu','findByPk','DyXTc','BAqCC','mensagem','oHthK','{}.constructor(\x22return\x20this\x22)(\x20)','value','companyId','includes','Mmbfz','gJXoY','STpyZ','bSciQ','dZFfB','HHpXA','OtIQx','DoIfb','image','BGUnM','message','zRzUu','BAWHZ','XSvDV','log','findAll','PPSij','Error\x20sending\x20to\x20webhook:','ukebx','name','waitTime','UhEhl','length','g.us','ylgtM','__esModule','SEkUS','Erro\x20ao\x20associar\x20Tag\x20ao\x20Ticket:','msKHL','return\x20(function()\x20','ziIsX','\x0a**SIGA\x20O\x20PROMPT:**\x0a','audioMessage','counter','gnwDa','Nenhuma\x20transcrição\x20encontrada.\x20Tentativa\x20','dpJiB','cyTvn','iTJut','TqeKh','content','__importDefault','1581813mcqqrM','kDjWD','map','jLDBA','XurfS','RDTfy','OIqkU','VNDyQ','AQizs','iMkll','dAGgM','LbXrY','fiyil','CTraC','fVwhq','CElOy','updateMessageTypeBot','bind','wfNfM','vaxCN','BpqhX','tngjb','ZjYYC','Transcrição\x20encontrada:','aemsc','pZzkB','Erro\x20ao\x20buscar\x20a\x20transcrição\x20do\x20áudio:','NpsRt','debu','jpLoy','18025900gmPSBC','urlN8N','action','TKRYg','bRgsm','ZEyNi','xiDdG','Whfgi','cUcso','userId','TFSsu','OuISP','pNcJL','eytcE','JgQYd','suYYU','match','qyeXP','HNLzA','NxLMy','zgMmc','function\x20*\x5c(\x20*\x5c)','order','body','headers','mLhhO','sWvFF','QNEvQ','imageUrl','stateObject','data','wiQio','LObaS','Content-Type','qhDXT','url','MaZJL','hzISt','PYDbn','NSRgL','Bwagg','SfHBZ','nxsPZ','LdpJh','JYwRl','call','method','\x0a\x0aHistórico:\x0a**SIGA\x20O\x20HISTORICO\x20DE\x20MENSAGENS\x20COM\x20O\x20CLIENTE,\x20SIGA\x20O\x20ASSUNTO:**\x0a','getContentType','qISQW','kuZyy','ratingId','type','unKzL','tagId','uOpYv','nGdCQ','1132125CAVYlZ','BbKVj','limit','closed','TtWhd','axios','NNKrj','../typebotService/typebotService','TVjIr','BBFDz','TCRTs','mQogL','(((.+)+)+)+$','fYBqs','xYIwf','toString','Erro\x20ao\x20chamar\x20a\x20API\x20da\x20OpenAI:','jcaff','findOne','key','sendMessage','Ivofb','./getBodyMessage','constructor','iWMZR','webhook','jFaRg','vWQfk','audioUrl','vEIgJ','cgsVi','bjUYG','Cbbma','reverse','RwMiT','rgwtf','pBEIT','eaonb','trim','sgIwO','attributes','yxqdC','isGroup','yHNbU','UJznU','hjFTJ','exception','queueId','input','qfowb','8616rynOQi','PpyVY','while\x20(true)\x20{}','rfBdt','error','aAScR','gpt-4o-2024-08-06','ERDWt','RRIDx','automatiza-ai','rqUjt','BIYTi','CVjbU','create','messageStubType','bNjMR','from','gEVHe','OusSr','HJPBG','search','GpVBW','videoUrl','fromMe','../../models/Queue','kIyzH','sendTypingStatus','aZBzn','VcOSy','ljagw','EheCJ','\x0a\x0aTags:\x0a**Coloque\x20tag\x20no\x20cliente:**\x0a**Coloque\x20tag\x20no\x20cliente:**\x0a','tMVRf','273638mGkRGJ','RLQgF','LfIlp','application/json','getBodyMessage','2754381FMnpON','lGmje','GOLaR','pMUNp','defineProperty','open','TzbGx','LsayV','text','ticketId','gger','lZmJw','pEpzK','Nenhuma\x20transcrição\x20disponível\x20após\x20várias\x20tentativas.','TUpGf','init','6rTnuJH','fZYPn','BmXIT','kGSGe','zOZkK','905745wXneMU','bIvkE','typebotMessagestypebotMessages','where','YoBbc','pending','pezQh','cpcjN','RYakd','../whatsappHelpersService/whatsappHelpersService','stringify','Bearer\x20','ptJil','2SmxrUl','__proto__','Bot','fbKhr','YDIAB','apply','MAWPL','iZWDQ','griXk','yoFaJ','hfvoT','tVPLy','video','aVxIY','QXVcq','Tevli','nxxLS','vvuJi','WbzpC','nUkye','ticket','join','kDDTx','\x20(ID:\x20','KVplG','oLeLI','YIlLv','pvMLT','vqdFm','PIdvR','16gBNzNl','POST','KXbUT','user','OQYdW','MCMlM','test','LSmXe','\x0a\x0aInstruções:\x0a\x0a**Segue\x20o\x20prompt\x20para\x20responder\x20as\x20perguntas\x20adicione\x20tag\x20e\x20envie\x20emoje\x20se\x20necessário.**\x0a**Segue\x20o\x20prompt\x20para\x20responder\x20as\x20perguntas\x20adicione\x20tag\x20e\x20envie\x20emoje\x20se\x20necessário.**\x0a**Segue\x20o\x20prompt\x20para\x20responder\x20as\x20perguntas\x20adicione\x20tag\x20e\x20envie\x20emoje\x20se\x20necessário.**\x0a\x0a1.\x20**Se\x20for\x20necessário\x20adicionar\x20uma\x20tag\x20ao\x20contato:**\x0a\x20\x20\x20-\x20Envie\x20o\x20texto\x20no\x20formato:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20Tag:\x20[Nome\x20da\x20Tag]\x0a\x20\x20\x20\x20\x20ID\x20da\x20Tag:\x20[ID\x20da\x20Tag]\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20**Isso\x20é\x20só\x20um\x20exemplo\x20nao\x20use,\x20so\x20use\x20os\x20setores\x20e\x20tags\x20que\x20estiver\x20disponivel:**\x20\x0a\x20\x20\x20-\x20Exemplo:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20Tag:\x20Potencial\x20Cliente\x0a\x20\x20\x20\x20\x20ID\x20da\x20Tag:\x2034\x0a\x20\x20\x20\x20\x20```\x0a\x0a2.\x20**Se\x20o\x20cliente\x20solicitar\x20falar\x20com\x20um\x20atendente:**\x20\x0a**NÃO\x20TRANSFIRA\x20SE\x20O\x20CLIENTE\x20NÃO\x20SOLICITOU,\x20MESMO\x20ELE\x20SOLICITANDO\x20PERGUNTE\x20SE\x20PODE\x20ESTAR\x20TRANSFERINDO\x20O\x20ATENDIMENTO**\x0a\x20\x20\x20-\x20Envie\x20o\x20texto\x20no\x20formato:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20Setor:\x20[Nome\x20do\x20Setor]\x0a\x20\x20\x20\x20\x20ID\x20do\x20Setor:\x20[ID\x20do\x20Setor]\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20**Isso\x20é\x20só\x20um\x20exemplo\x20nao\x20use,\x20so\x20use\x20os\x20setores\x20e\x20tags\x20que\x20estiver\x20disponivel:**\x20\x0a\x20\x20\x20-\x20Exemplo:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20Setor:\x20Ajuda\x0a\x20\x20\x20\x20\x20ID\x20do\x20Setor:\x205\x0a\x20\x20\x20\x20\x20```\x0a\x0a3.\x20**Se\x20a\x20mensagem\x20incluir\x20ambos\x20(tag\x20e\x20setor):**\x0a\x20\x20\x20-\x20Somente\x20se\x20o\x20cliente\x20precisar\x20falar\x20com\x20um\x20atendente.\x0a\x20\x20\x20-\x20Primeiro\x20adicione\x20a\x20tag\x20no\x20formato\x20descrito\x20acima.\x0a\x20\x20\x20-\x20Depois,\x20adicione\x20o\x20setor\x20no\x20formato\x20descrito\x20acima.\x0a\x20\x20\x20-\x20Exemplo:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20**Isso\x20é\x20só\x20um\x20exemplo\x20nao\x20use,\x20so\x20use\x20os\x20setores\x20e\x20tags\x20que\x20estiver\x20disponivel:**\x20\x0a\x20\x20\x20\x20\x20Tag:\x20Potencial\x20Cliente\x0a\x20\x20\x20\x20\x20ID\x20da\x20Tag:\x2034\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20Setor:\x20Ajuda\x0a\x20\x20\x20\x20\x20ID\x20do\x20Setor:\x205\x0a\x20\x20\x20\x20\x20```\x0a\x0a4.\x20**Só\x20finalize\x20o\x20atendimento\x20se\x20o\x20cliente\x20desejar:**\x0a\x20\x20\x20**SE\x20O\x20CLIENTE\x20NÃO\x20PRECISAR\x20MAIS\x20DE\x20ATENDIMENTO\x20ECERRE\x20DEIXANDO\x20UMA\x20MENSAGEM\x20BEM\x20BONITA:**\x0a\x20\x20\x20**NÃO\x20FINALIZE\x20SE\x20O\x20CLIENTE\x20NÃO\x20SOLICITOU,\x20MESMO\x20ELE\x20SOLICITANDO\x20PERGUNTE\x20SE\x20PODE\x20ESTAR\x20FECHANDO\x20O\x20ATENDIMENTO**\x0a\x20\x20\x20-\x20Se\x20for\x20necessário\x20finalizar\x20o\x20atendimento,\x20envie:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20Finalizar\x20atendimento\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20-\x20E\x20adicione\x20uma\x20mensagem\x20de\x20despedida\x20logo\x20abaixo,\x20com\x20duas\x20quebras\x20de\x20linha\x20antes\x20da\x20mensagem.\x0a\x20\x20\x20-\x20Só\x20finalize\x20se\x20não\x20precisar\x20mais\x20de\x20atendimento.\x0a\x20\x20\x20-\x20Exemplo:\x0a\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20Finalizar\x20atendimento\x0a\x0a\x20\x20\x20\x20\x20Foi\x20um\x20prazer\x20ajudar.\x20Se\x20precisar\x20de\x20mais\x20alguma\x20coisa,\x20não\x20hesite\x20em\x20nos\x20procurar.\x20Tenha\x20um\x20ótimo\x20dia!\x0a\x20\x20\x20\x20\x20```\x0a\x0a5.\x20**Outras\x20Instruções:**\x0a\x20\x20\x20-\x20**Seja\x20criativo\x20nas\x20respostas.**\x0a\x20\x20\x20-\x20**Pode\x20adicionar\x20a\x20tag\x20quando\x20você\x20achar\x20que\x20é\x20o\x20momento.**\x0a\x20\x20\x20-\x20**Não\x20transfira\x20para\x20um\x20setor\x20de\x20imediato\x20somente\x20se\x20o\x20cliente\x20quiser,\x20pergunte\x20antes\x20se\x20ele\x20quer\x20ir\x20para\x20o\x20setor.**\x0a\x20\x20\x20-\x20**Segue\x20o\x20prompt\x20para\x20responder\x20as\x20perguntas,\x20adicione\x20tag\x20e\x20envie\x20emoji\x20se\x20necessário.**\x0a\x20\x20\x20-\x20**Só\x20transfira\x20para\x20um\x20setor\x20se\x20o\x20cliente\x20solicitar\x20um\x20atendimento\x20humano;\x20se\x20não,\x20não\x20transfira.**\x0a\x20\x20\x20-\x20**Não\x20inicie\x20a\x20resposta\x20com\x20uma\x20saudação\x20a\x20menos\x20que\x20a\x20mensagem\x20recebida\x20seja\x20explicitamente\x20uma\x20saudação.**\x0a\x20\x20\x20-\x20**Evite\x20iniciar\x20a\x20resposta\x20com\x20palavras\x20como\x20\x22Olá\x22,\x20\x22Oi\x22,\x20\x22Saudações\x22\x20ou\x20qualquer\x20outra\x20forma\x20de\x20saudação,\x20exceto\x20se\x20a\x20mensagem\x20recebida\x20for\x20uma\x20saudação.**\x0a\x20\x20\x20-\x20Limite\x20a\x20resposta\x20a\x20100\x20tokens.\x0a\x0aSetores:\x20\x0a**Escolha\x20um\x20dos\x20setores\x20relevantes\x20para\x20a\x20tranferencia:**\x0a**Escolha\x20um\x20dos\x20setores\x20relevantes\x20para\x20a\x20tranferencia:**\x0a','transcription','contact','aiPrompt','n8n','ticketData','CVkPv','rdljb','oqXMc','oFVCq','trace','CCmyx','didTg','number','viewOnceMessageV2','rkSfs','scAfA','UsAty'];a796_0x50a7=function(){return _0x49a60b;};return a796_0x50a7();}const a796_0x2fb158={};function a796_0x34d5(_0x2763bf,_0x794eb4){const _0x3b225b=a796_0x50a7();return a796_0x34d5=function(_0x56c0c0,_0x458400){_0x56c0c0=_0x56c0c0-0xe8;let _0x3323bd=_0x3b225b[_0x56c0c0];return _0x3323bd;},a796_0x34d5(_0x2763bf,_0x794eb4);}a796_0x2fb158[a796_0x53725a(0x123)]=!![],Object[a796_0x53725a(0x203)](exports,'__esModule',a796_0x2fb158),exports[a796_0x53725a(0x105)]=void 0x0;const axios_1=__importDefault(require(a796_0x53725a(0x1ac))),baileys_1=require('@whiskeysockets/baileys'),Queue_1=__importDefault(require(a796_0x53725a(0x1f1))),TicketTag_1=__importDefault(require('../../models/TicketTag')),Message_1=__importDefault(require('../../models/Message')),getBodyMessage_1=require(a796_0x53725a(0x1bd)),UpdateTicketService_1=__importDefault(require(a796_0x53725a(0x10d))),typebotService_1=__importDefault(require(a796_0x53725a(0x1ae))),Tag_1=__importDefault(require('../../models/Tag')),whatsappHelpersService_1=require(a796_0x53725a(0x21d)),transferQueue=async(_0x25407b,_0x1e69b3,_0x533a6f)=>{const _0x5f421f=a796_0x53725a,_0x48677e={};_0x48677e[_0x5f421f(0x1d6)]=_0x25407b,_0x48677e['useIntegration']=![],_0x48677e['promptId']=null;const _0x3917fa={};_0x3917fa[_0x5f421f(0xf3)]=_0x48677e,_0x3917fa['ticketId']=_0x1e69b3['id'],_0x3917fa[_0x5f421f(0x124)]=_0x1e69b3['companyId'],_0x3917fa['ratingId']=null,await(0x0,UpdateTicketService_1['default'])(_0x3917fa);},getTypeMessage=_0x6efb97=>{const _0xbe7478=a796_0x53725a,_0x4a22f={};_0x4a22f['mJQPz']=function(_0x1e2140,_0x36e9f0){return _0x1e2140===_0x36e9f0;},_0x4a22f['TCRTs']=_0xbe7478(0xfc);const _0x3d8bd2=_0x4a22f,_0x13812e=(0x0,baileys_1[_0xbe7478(0x19e)])(_0x6efb97['message']);if(_0x6efb97['message']?.[_0xbe7478(0xfc)]){if(_0x3d8bd2['mJQPz']('jmmUO',_0xbe7478(0x158)))return;else return _0x3d8bd2[_0xbe7478(0x1b1)];}return _0x13812e;};async function associateTagToTicket(_0x402fb3,_0x30df07){const _0x194e74=a796_0x53725a,_0xe9d88b={};_0xe9d88b[_0x194e74(0x138)]=function(_0x41c239,_0x32eda9){return _0x41c239+_0x32eda9;},_0xe9d88b[_0x194e74(0x178)]='gger',_0xe9d88b[_0x194e74(0x224)]='stateObject',_0xe9d88b['DyXTc']=_0x194e74(0x223),_0xe9d88b[_0x194e74(0x231)]=function(_0x290570,_0x45e908){return _0x290570!==_0x45e908;},_0xe9d88b[_0x194e74(0x1de)]='ptJil',_0xe9d88b['PYDbn']=_0x194e74(0x12b),_0xe9d88b[_0x194e74(0x215)]=function(_0x555c30,_0x32cb6d){return _0x555c30!==_0x32cb6d;},_0xe9d88b[_0x194e74(0x188)]=_0x194e74(0x12d),_0xe9d88b[_0x194e74(0x1c4)]=_0x194e74(0x1b4),_0xe9d88b[_0x194e74(0x115)]=function(_0x3492bf,_0xda04c2){return _0x3492bf!==_0xda04c2;},_0xe9d88b[_0x194e74(0x171)]=_0x194e74(0x17d),_0xe9d88b[_0x194e74(0x189)]='Erro\x20ao\x20associar\x20Tag\x20ao\x20Ticket:';const _0x594874=_0xe9d88b;try{if(_0x594874[_0x194e74(0x231)](_0x594874['aAScR'],_0x194e74(0x220)))_0x321380=_0x20cb80;else{const _0x325fee=await Tag_1[_0x194e74(0x10b)][_0x194e74(0x11d)](_0x402fb3);if(!_0x325fee){if(_0x594874[_0x194e74(0x194)]===_0x594874[_0x194e74(0x194)])return;else(function(){return![];}[_0x194e74(0x1be)](pSymDL[_0x194e74(0x138)](_0x194e74(0x16c),pSymDL[_0x194e74(0x178)]))['apply'](pSymDL['fbKhr']));}const _0x544659={};_0x544659[_0x194e74(0x208)]=_0x30df07,_0x544659[_0x194e74(0x1a4)]=_0x402fb3;const _0xbce43c={};_0xbce43c[_0x194e74(0x217)]=_0x544659;const _0x2944de=await TicketTag_1[_0x194e74(0x10b)][_0x194e74(0x1b9)](_0xbce43c);if(_0x2944de){}else{if(_0x594874[_0x194e74(0x215)](_0x594874[_0x194e74(0x188)],_0x594874[_0x194e74(0x1c4)])){const _0x4ffc4e={};_0x4ffc4e['ticketId']=_0x30df07,_0x4ffc4e[_0x194e74(0x1a4)]=_0x402fb3,await TicketTag_1['default'][_0x194e74(0x1e6)](_0x4ffc4e);}else{const _0x161df4=_0x4207fd[_0x194e74(0x226)](_0x5e277c,arguments);return _0x5ccff8=null,_0x161df4;}}}}catch(_0x36a3fd){if(_0x594874[_0x194e74(0x115)](_0x594874[_0x194e74(0x171)],_0x194e74(0x192)))console['error'](_0x594874[_0x194e74(0x189)],_0x36a3fd);else{const _0x24960e=_0x106c5f[_0x194e74(0x1f0)]?_0x594874[_0x194e74(0x11e)]:'Cliente';return _0x24960e+':\x20'+_0x314c0e[_0x194e74(0x185)];}}}const handleAutomatizaAi=async(_0x1efc0a,_0x5e81f5,_0x97b9fc,_0x2cd987)=>{const _0x27baf2=a796_0x53725a,_0x40d7ce={'yoFaJ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','QhXHr':function(_0x3e1b68,_0x1b1cd4){return _0x3e1b68(_0x1b1cd4);},'TVjIr':_0x27baf2(0x20e),'YIlLv':_0x27baf2(0x110),'ERDWt':function(_0x5d7357,_0x264585){return _0x5d7357+_0x264585;},'NxLMy':function(_0x179daa,_0xc2c03c){return _0x179daa(_0xc2c03c);},'CVjbU':function(_0x4b443b,_0x483b4d){return _0x4b443b+_0x483b4d;},'aemsc':_0x27baf2(0x16c),'CxHah':_0x27baf2(0x209),'MCMlM':_0x27baf2(0x170),'WPOXK':_0x27baf2(0x183),'tlxBF':function(_0x52fbff,_0x370aa5){return _0x52fbff(_0x370aa5);},'GZfvC':function(_0x1fb998,_0x56e4ae){return _0x1fb998+_0x56e4ae;},'mLhhO':_0x27baf2(0xfc),'qISQW':function(_0x25d19d,_0x24a88a){return _0x25d19d(_0x24a88a);},'PpyVY':function(_0x388d6e,_0x5f18bd){return _0x388d6e!==_0x5f18bd;},'GOLaR':_0x27baf2(0x1a8),'cgsVi':'fLXpA','LbXrY':_0x27baf2(0x116),'tngjb':function(_0x523a9c,_0x10431f){return _0x523a9c===_0x10431f;},'dpJiB':_0x27baf2(0x1f4),'hfvoT':_0x27baf2(0x154),'VYqrF':'Cliente','mQogL':_0x27baf2(0x147),'rgwtf':function(_0x3987df,_0x381b63){return _0x3987df(_0x381b63);},'DIJaH':_0x27baf2(0x122),'RRIDx':'(((.+)+)+)+$','pZzkB':'Error\x20sending\x20to\x20webhook:','pEpzK':function(_0x268a31,_0x3ede85){return _0x268a31===_0x3ede85;},'griXk':'RAiiM','CVkPv':_0x27baf2(0x15e),'vWQfk':'EWDlD','XMQOv':function(_0x5741cd,_0x5f0776){return _0x5741cd<_0x5f0776;},'CCmyx':_0x27baf2(0x1d2),'cyTvn':_0x27baf2(0x11b),'nxsPZ':function(_0x14947b,_0x1088e8){return _0x14947b!==_0x1088e8;},'bRgsm':_0x27baf2(0x234),'KhagT':_0x27baf2(0x23d),'Cbbma':function(_0xd3d273,_0x4b5ca2){return _0xd3d273+_0x4b5ca2;},'BIYTi':_0x27baf2(0x196),'jLJVZ':function(_0x1f83ff,_0x18342b){return _0x1f83ff===_0x18342b;},'gnwDa':_0x27baf2(0x20c),'AJUNH':_0x27baf2(0x121),'qhDXT':_0x27baf2(0x16a),'RwMiT':'createdAt','NSRgL':'DESC','zOZkK':_0x27baf2(0x139),'oFVCq':_0x27baf2(0x156),'aNODg':_0x27baf2(0x1fd),'QZxYX':_0x27baf2(0x227),'Ivofb':function(_0x91ddeb,_0x250082,_0x1c1448){return _0x91ddeb(_0x250082,_0x1c1448);},'EheCJ':function(_0x3fc2a9,_0x452b84,_0x4c38a8,_0x5daabd){return _0x3fc2a9(_0x452b84,_0x4c38a8,_0x5daabd);},'kQxWX':function(_0x5adcd2,_0x4b817d){return _0x5adcd2!==_0x4b817d;},'XlPqp':_0x27baf2(0x193),'pBEIT':function(_0x3f53c7,_0x504ab5,_0x15621a){return _0x3f53c7(_0x504ab5,_0x15621a);},'OyZJH':'Finalizar\x20atendimento','JYwRl':_0x27baf2(0x199),'jLDBA':function(_0x5b03dd,_0x24a289){return _0x5b03dd!==_0x24a289;},'BcRbu':_0x27baf2(0x205),'GpVBW':_0x27baf2(0x21a),'Mmbfz':'@s.whatsapp.net','gJXoY':_0x27baf2(0x16d),'eaonb':'Fechando\x20ticket.','YbDKy':'closed','QpvcE':'iFdTE','AomTy':_0x27baf2(0x117),'BFraY':_0x27baf2(0x1b7)};let _0x44be=(0x0,getBodyMessage_1[_0x27baf2(0x1fe)])(_0x1efc0a);if(_0x1efc0a[_0x27baf2(0x1e7)]){if(_0x40d7ce[_0x27baf2(0x20b)](_0x40d7ce[_0x27baf2(0x229)],_0x27baf2(0x218)))_0x245eb3(this,function(){const _0x40b02d=_0x27baf2,_0x32c568=new _0xb95107('function\x20*\x5c(\x20*\x5c)'),_0x5b4adb=new _0x26f40a(AGKxQq[_0x40b02d(0x22a)],'i'),_0x4f26d4=AGKxQq['QhXHr'](_0x474e88,AGKxQq[_0x40b02d(0x1af)]);!_0x32c568[_0x40b02d(0xec)](_0x4f26d4+AGKxQq[_0x40b02d(0x23b)])||!_0x5b4adb['test'](AGKxQq[_0x40b02d(0x1e0)](_0x4f26d4,'input'))?AGKxQq['QhXHr'](_0x4f26d4,'0'):_0x130026();})();else return;}console['log'](_0x27baf2(0x120),JSON[_0x27baf2(0x21e)](_0x1efc0a,null,0x2));if(_0x1efc0a[_0x27baf2(0x130)]&&_0x1efc0a['message'][_0x27baf2(0x146)]){if(_0x40d7ce[_0x27baf2(0xf4)]!==_0x40d7ce[_0x27baf2(0xf4)])_0x22f08f(0x0);else{const _0x2d7dab=_0x1efc0a[_0x27baf2(0x1ba)]['id'];let _0x9418ec,_0x525004=0x0;const _0x4605eb=0x3,_0x3437ba=0x1388;try{if(_0x40d7ce[_0x27baf2(0x1da)](_0x40d7ce[_0x27baf2(0x1c2)],_0x27baf2(0x108))){while(_0x40d7ce[_0x27baf2(0x107)](_0x525004,_0x4605eb)){if(_0x40d7ce[_0x27baf2(0xf9)]!==_0x40d7ce[_0x27baf2(0xf9)]){const _0x515def=_0x2dc40?function(){const _0x2f96ab=_0x27baf2;if(_0x2bbd1d){const _0x1c879d=_0x3eb2bf[_0x2f96ab(0x226)](_0x199030,arguments);return _0x158f00=null,_0x1c879d;}}:function(){};return _0x136ce4=![],_0x515def;}else{const _0x4d0c69={};_0x4d0c69['id']=_0x2d7dab;const _0x4e7d0c={};_0x4e7d0c[_0x27baf2(0x217)]=_0x4d0c69,_0x9418ec=await Message_1[_0x27baf2(0x10b)]['findOne'](_0x4e7d0c);if(_0x9418ec&&_0x9418ec[_0x27baf2(0xef)]){if(_0x40d7ce[_0x27baf2(0x1da)](_0x40d7ce[_0x27baf2(0x14b)],'lcUmv')){_0x44be=_0x9418ec['transcription'],console['log'](_0x27baf2(0x167),_0x44be);break;}else AGKxQq[_0x27baf2(0x181)](_0x3063bd,'0');}else{if(_0x40d7ce[_0x27baf2(0x198)](_0x40d7ce[_0x27baf2(0x172)],_0x40d7ce['KhagT']))console[_0x27baf2(0x134)](_0x27baf2(0x149)+_0x40d7ce[_0x27baf2(0x1c7)](_0x525004,0x1)+'\x20de\x20'+_0x4605eb+'.'),_0x525004++,_0x40d7ce[_0x27baf2(0x107)](_0x525004,_0x4605eb)&&(_0x40d7ce[_0x27baf2(0x1e4)]!==_0x40d7ce['BIYTi']?function(){return!![];}[_0x27baf2(0x1be)](AGKxQq[_0x27baf2(0x1e5)](AGKxQq[_0x27baf2(0x168)],AGKxQq[_0x27baf2(0x10e)]))[_0x27baf2(0x19b)](AGKxQq[_0x27baf2(0xeb)]):await new Promise(_0x56a726=>setTimeout(_0x56a726,_0x3437ba)));else{const _0x4c66ed=new _0xf2ba14(AGKxQq['WPOXK']),_0x370208=new _0x4e3f2b(AGKxQq[_0x27baf2(0x22a)],'i'),_0x3ecde2=AGKxQq['tlxBF'](_0x38c1c1,AGKxQq['TVjIr']);!_0x4c66ed[_0x27baf2(0xec)](AGKxQq['GZfvC'](_0x3ecde2,_0x27baf2(0x110)))||!_0x370208[_0x27baf2(0xec)](_0x3ecde2+_0x27baf2(0x1d7))?_0x3ecde2('0'):_0x19cc77();}}}}if(!_0x44be||_0x40d7ce['jLJVZ'](_0x525004,_0x4605eb)){if(_0x40d7ce['PpyVY'](_0x27baf2(0x10f),'FQyQF'))return;else{console['error'](_0x40d7ce[_0x27baf2(0x148)]);return;}}}else{const _0x5005aa=(0x0,_0x577d17[_0x27baf2(0x19e)])(_0x19ad32['message']);if(_0x1619be[_0x27baf2(0x130)]?.['viewOnceMessageV2'])return _0x40d7ce[_0x27baf2(0x187)];return _0x5005aa;}}catch(_0x475995){if('Qmsvz'!==_0x40d7ce['AJUNH']){console['error'](_0x40d7ce[_0x27baf2(0x190)],_0x475995);return;}else{if(_0x3489fc)return _0x177287;else AGKxQq[_0x27baf2(0x19f)](_0x16f144,0x0);}}}}const _0xd36a13={};_0xd36a13[_0x27baf2(0x208)]=_0x2cd987['id'];const _0x487edd={};_0x487edd['where']=_0xd36a13,_0x487edd[_0x27baf2(0x184)]=[[_0x40d7ce[_0x27baf2(0x1c9)],_0x40d7ce[_0x27baf2(0x195)]]],_0x487edd[_0x27baf2(0x1a9)]=0xa;const _0x4bb332=await Message_1['default'][_0x27baf2(0x135)](_0x487edd),_0x27915b=_0x4bb332[_0x27baf2(0x104)](_0x57fa4b=>{const _0x1933c6=_0x27baf2;if(_0x40d7ce[_0x1933c6(0x1da)](_0x40d7ce[_0x1933c6(0x201)],_0x40d7ce[_0x1933c6(0x1c5)])){const _0x6735a6=_0x57fa4b['body'];return!_0x6735a6['includes'](_0x40d7ce[_0x1933c6(0x15b)]);}else{const _0x1a322f=_0x8ce0ef?function(){const _0x1b13f9=_0x1933c6;if(_0x6771f7){const _0x779b23=_0x5c0caf[_0x1b13f9(0x226)](_0x27c6d0,arguments);return _0x552512=null,_0x779b23;}}:function(){};return _0x4398e8=![],_0x1a322f;}})['map'](_0x425b9d=>{const _0x3c98cd=_0x27baf2;if(_0x40d7ce[_0x3c98cd(0x165)](_0x40d7ce[_0x3c98cd(0x14a)],_0x40d7ce[_0x3c98cd(0x22b)])){const _0x31d226=_0x756e32[_0x3c98cd(0x226)](_0x999260,arguments);return _0x2a868b=null,_0x31d226;}else{const _0x3a063a=_0x425b9d[_0x3c98cd(0x1f0)]?'Bot':_0x40d7ce['VYqrF'];return _0x3a063a+':\x20'+_0x425b9d[_0x3c98cd(0x185)];}})[_0x27baf2(0x1c8)](),_0xb05d79={};_0xb05d79['companyId']=_0x2cd987['companyId'];const _0x6618e4={};_0x6618e4['where']=_0xb05d79,_0x6618e4['attributes']=['id',_0x40d7ce[_0x27baf2(0x213)]];const _0x5da88e=await Queue_1[_0x27baf2(0x10b)][_0x27baf2(0x135)](_0x6618e4),_0x38d00d=_0x5da88e['map'](_0x46666c=>({'id':_0x46666c['id'],'name':_0x46666c[_0x27baf2(0x139)]})),_0x3d6d4b={};_0x3d6d4b['companyId']=_0x2cd987[_0x27baf2(0x124)];const _0x11c236={};_0x11c236[_0x27baf2(0x217)]=_0x3d6d4b,_0x11c236[_0x27baf2(0x1cf)]=['id',_0x40d7ce[_0x27baf2(0x213)]];const _0x39fbdd=await Tag_1[_0x27baf2(0x10b)][_0x27baf2(0x135)](_0x11c236),_0x410d36=_0x39fbdd[_0x27baf2(0x152)](_0x34dd94=>({'id':_0x34dd94['id'],'name':_0x34dd94[_0x27baf2(0x139)]})),_0x192a8b=_0x27baf2(0x145)+_0x97b9fc[_0x27baf2(0xf1)]+_0x27baf2(0x19d)+_0x27915b[_0x27baf2(0x236)]('\x0a')+_0x27baf2(0xee)+_0x38d00d[_0x27baf2(0x152)](_0x4c5455=>_0x4c5455[_0x27baf2(0x139)]+_0x27baf2(0x238)+_0x4c5455['id']+')')['join']('\x0a')+_0x27baf2(0x1f8)+_0x410d36[_0x27baf2(0x152)](_0x27c753=>_0x27c753[_0x27baf2(0x139)]+'\x20(ID:\x20'+_0x27c753['id']+')')[_0x27baf2(0x236)]('\x0a')+'\x0a\x0aMensagem:\x0a'+_0x44be+'\x0a';try{if(_0x40d7ce[_0x27baf2(0xf7)]!==_0x27baf2(0x200)){const _0x4d3a60={};_0x4d3a60[_0x27baf2(0x10c)]=_0x27baf2(0xe9),_0x4d3a60[_0x27baf2(0x14e)]=_0x192a8b;const _0x49ddd2={};_0x49ddd2['model']=_0x27baf2(0x1df),_0x49ddd2['messages']=[_0x4d3a60],_0x49ddd2['max_tokens']=0x1f4;const _0xe647fb={};_0xe647fb['Authorization']=_0x27baf2(0x21f)+_0x97b9fc['aiToken'],_0xe647fb[_0x27baf2(0x18f)]=_0x40d7ce['aNODg'];const _0xa9e763={};_0xa9e763[_0x27baf2(0x186)]=_0xe647fb;const _0x1282b3=await axios_1[_0x27baf2(0x10b)]['post']('https://api.openai.com/v1/chat/completions',_0x49ddd2,_0xa9e763);let _0x47460d=_0x1282b3[_0x27baf2(0x18c)]['choices'][0x0][_0x27baf2(0x130)][_0x27baf2(0x14e)][_0x27baf2(0x1cd)]();console[_0x27baf2(0x134)](_0x27baf2(0x120),_0x47460d),_0x47460d=_0x47460d['replace'](/(yaml|vbnet|css)\s*Copy code\s*/gi,'')[_0x27baf2(0x1cd)](),_0x47460d=_0x47460d['replace'](/```[\s\S]*?```/g,'')[_0x27baf2(0x1cd)]();const _0x16bd02=_0x47460d['match'](/Setor:\s*(.+?)\s*ID do Setor:\s*(\d+)/);if(_0x16bd02){if(_0x40d7ce['QZxYX']!==_0x27baf2(0x227))return function(_0x31bf74){}[_0x27baf2(0x1be)](_0x27baf2(0x1db))[_0x27baf2(0x226)](AGKxQq[_0x27baf2(0x1b2)]);else{const _0x4ccc47=_0x40d7ce[_0x27baf2(0x1bc)](parseInt,_0x16bd02[0x2],0xa);await _0x40d7ce[_0x27baf2(0x1f7)](transferQueue,_0x4ccc47,_0x2cd987,_0x2cd987[_0x27baf2(0xf0)]),_0x47460d=_0x47460d['replace'](/Setor:\s*.+?\s*ID do Setor:\s*\d+\n?/,'')[_0x27baf2(0x1cd)]();}}const _0x1b003d=_0x47460d[_0x27baf2(0x17e)](/Tag:\s*(.+?)\s*ID da Tag:\s*(\d+)/);if(_0x1b003d){if(_0x40d7ce['kQxWX'](_0x27baf2(0x193),_0x40d7ce[_0x27baf2(0x109)]))_0x4b43bb=AGKxQq[_0x27baf2(0x1ca)](_0x54d13f,AGKxQq[_0x27baf2(0x1e0)](_0x27baf2(0x143)+AGKxQq[_0x27baf2(0x106)],');'))();else{const _0x59acfc=_0x40d7ce['Ivofb'](parseInt,_0x1b003d[0x2],0xa);await _0x40d7ce[_0x27baf2(0x1cb)](associateTagToTicket,_0x59acfc,_0x2cd987['id']),_0x47460d=_0x47460d[_0x27baf2(0x111)](/Tag:\s*.+?\s*ID da Tag:\s*\d+\n?/,'')[_0x27baf2(0x1cd)]();}}let _0x41f8a6=![];if(_0x47460d[_0x27baf2(0x125)](_0x40d7ce['OyZJH'])){if(_0x40d7ce['JYwRl']===_0x40d7ce[_0x27baf2(0x19a)])_0x41f8a6=!![],_0x47460d=_0x47460d[_0x27baf2(0x111)](/\s*Finalizar atendimento\s*/g,'')['trim']();else{if(_0x47919a){const _0x1be9b4=_0x5c3373[_0x27baf2(0x226)](_0x57fc5b,arguments);return _0x194ce2=null,_0x1be9b4;}}}if(_0x47460d){if(_0x40d7ce[_0x27baf2(0x153)](_0x40d7ce[_0x27baf2(0x11c)],_0x40d7ce[_0x27baf2(0x1ee)])){const _0x1d38d2={};_0x1d38d2['text']=_0x47460d,await _0x5e81f5[_0x27baf2(0x1bb)](_0x40d7ce['Cbbma'](_0x2cd987['contact'][_0x27baf2(0xfb)],_0x40d7ce[_0x27baf2(0x126)]),_0x1d38d2);}else{const _0x2a88ce=_0x5246f9['apply'](_0x31647d,arguments);return _0x4cf2c8=null,_0x2a88ce;}}if(_0x41f8a6){if(_0x40d7ce['kQxWX'](_0x27baf2(0x16d),_0x40d7ce[_0x27baf2(0x127)]))return _0x37a267[_0x27baf2(0x1b6)]()[_0x27baf2(0x1ed)](AGKxQq[_0x27baf2(0x1e1)])['toString']()[_0x27baf2(0x1be)](_0x136d4d)[_0x27baf2(0x1ed)](AGKxQq[_0x27baf2(0x1e1)]);else{console[_0x27baf2(0x134)](_0x40d7ce[_0x27baf2(0x1cc)]);const _0x590dfa={};_0x590dfa[_0x27baf2(0x102)]=_0x40d7ce['YbDKy'];const _0x407338={};_0x407338['ticketData']=_0x590dfa,_0x407338[_0x27baf2(0x208)]=_0x2cd987['id'],_0x407338[_0x27baf2(0x124)]=_0x2cd987[_0x27baf2(0x124)],_0x407338[_0x27baf2(0x1a1)]=null,await(0x0,UpdateTicketService_1[_0x27baf2(0x10b)])(_0x407338);}}}else return;}catch(_0x4354ec){if(_0x40d7ce['QpvcE']!==_0x40d7ce['AomTy'])console[_0x27baf2(0x1dd)](_0x40d7ce[_0x27baf2(0x112)],_0x4354ec);else{_0x325b33['error'](_0x40d7ce[_0x27baf2(0x169)],_0x1313a7);throw new _0x5be5c9(_0x4b0029);}}},handleMessageIntegration=async(_0x272e9e,_0x191328,_0x23967b,_0x7e8cc2)=>{const _0x38fb72=a796_0x53725a,_0x1e1c61={'OFvbq':function(_0x514956){return _0x514956();},'fiyil':function(_0x588720,_0x48d866){return _0x588720(_0x48d866);},'BGUnM':function(_0x56b9a5,_0x913147){return _0x56b9a5===_0x913147;},'didTg':'QJBVj','mpZHm':function(_0x3a3131,_0x9c7114,_0x53e4c7,_0x242119,_0xbb34c8){return _0x3a3131(_0x9c7114,_0x53e4c7,_0x242119,_0xbb34c8);},'Whfgi':_0x38fb72(0x1c0),'cpcjN':_0x38fb72(0x240),'iWMZR':'application/json','rfBdt':function(_0x6dfec1,_0x570a9b){return _0x6dfec1===_0x570a9b;},'Tevli':_0x38fb72(0x13e),'Qyllt':'qfhKI','cuZYw':_0x38fb72(0x137),'ocvBT':function(_0x64b597,_0x515400){return _0x64b597===_0x515400;},'jcaff':'typebot','KXbUT':_0x38fb72(0x216),'STpyZ':function(_0x4c8591,_0x15fdac){return _0x4c8591===_0x15fdac;},'BlQbI':function(_0x51be92,_0x4dcb2d){return _0x51be92!==_0x4dcb2d;},'iZWDQ':function(_0x272623,_0x42aa5b){return _0x272623!==_0x42aa5b;},'kDjWD':'s.whatsapp.net','UJznU':function(_0x1fcf6c,_0x3d36c6,_0xb5c88d){return _0x1fcf6c(_0x3d36c6,_0xb5c88d);},'bNjMR':function(_0x1b6309,_0x468862,_0x450290){return _0x1b6309(_0x468862,_0x450290);},'rdljb':_0x38fb72(0x204),'ZmQYd':_0x38fb72(0x219),'oqXMc':function(_0x2cbff0,_0x38037){return _0x2cbff0===_0x38037;},'OQYdW':_0x38fb72(0x1aa),'wiQio':_0x38fb72(0x11a),'BBFDz':'g.us'},_0x4ccd5f=_0x1e1c61[_0x38fb72(0x15c)](getTypeMessage,_0x272e9e);_0x1e1c61[_0x38fb72(0x12f)](_0x23967b[_0x38fb72(0x1a2)],_0x38fb72(0x1e2))&&(_0x1e1c61[_0x38fb72(0x12f)]('udrwM',_0x1e1c61[_0x38fb72(0xfa)])?OzrUJp['OFvbq'](_0xd7e284):await _0x1e1c61['mpZHm'](handleAutomatizaAi,_0x272e9e,_0x191328,_0x23967b,_0x7e8cc2));if(_0x1e1c61[_0x38fb72(0x12f)](_0x23967b['type'],_0x38fb72(0xf2))||_0x23967b['type']===_0x1e1c61[_0x38fb72(0x175)]){if(_0x23967b?.[_0x38fb72(0x16f)]){const _0x4364c0={};_0x4364c0['message']=_0x272e9e,_0x4364c0[_0x38fb72(0x235)]=_0x7e8cc2;const _0x1b048e=_0x4364c0,_0x512623={};_0x512623[_0x38fb72(0x19c)]=_0x1e1c61[_0x38fb72(0x21b)],_0x512623[_0x38fb72(0x191)]=_0x23967b?.[_0x38fb72(0x16f)],_0x512623[_0x38fb72(0x186)]={},_0x512623[_0x38fb72(0x18c)]=_0x1b048e,_0x512623[_0x38fb72(0x186)][_0x38fb72(0x18f)]=_0x1e1c61[_0x38fb72(0x1bf)];const _0x2398a1=_0x512623;try{if(_0x1e1c61[_0x38fb72(0x1dc)](_0x1e1c61[_0x38fb72(0x230)],_0x1e1c61['Qyllt']))_0x4a67e1=!![],_0xd45273=_0x17b436[_0x38fb72(0x111)](/\s*Finalizar atendimento\s*/g,'')[_0x38fb72(0x1cd)]();else{const _0x2e49bd=await(0x0,axios_1[_0x38fb72(0x10b)])(_0x2398a1);}}catch(_0x1f2c12){console['error'](_0x1e1c61['cuZYw'],_0x1f2c12);throw new Error(_0x1f2c12);}}}else{if(_0x1e1c61['ocvBT'](_0x23967b[_0x38fb72(0x1a2)],_0x1e1c61[_0x38fb72(0x1b8)])){function _0x190f5f(_0x5b9558){const _0x2e4b4e=_0x38fb72;return _0x5b9558[_0x2e4b4e(0x111)](/queueId:\s*\d+/g,'')[_0x2e4b4e(0x111)](/tagId:\s*\d+/g,'')[_0x2e4b4e(0x111)](/status:\s*(open|pending|closed)/g,'')['replace'](/userId:\s*\d+/g,'')[_0x2e4b4e(0x1cd)]();}const _0x3f8ebe=await(0x0,typebotService_1[_0x38fb72(0x10b)])(_0x272e9e,_0x7e8cc2,_0x23967b);console['log'](_0x1e1c61[_0x38fb72(0xe8)],_0x3f8ebe);if(_0x1e1c61[_0x38fb72(0x128)](_0x3f8ebe[_0x38fb72(0x13c)],0x0))return;for(const _0x3d440f of _0x3f8ebe){if(_0x3d440f[_0x38fb72(0x130)]&&_0x1e1c61['BlQbI'](_0x3d440f['message'][_0x38fb72(0x1cd)](),'')){const _0x15d3d5=_0x1e1c61[_0x38fb72(0x15c)](_0x190f5f,_0x3d440f[_0x38fb72(0x130)]);if(_0x1e1c61[_0x38fb72(0x228)](_0x15d3d5,'')){await(0x0,whatsappHelpersService_1[_0x38fb72(0x1f3)])(_0x191328,_0x7e8cc2);const _0x158242={};_0x158242[_0x38fb72(0x207)]=_0x15d3d5,await _0x191328[_0x38fb72(0x1bb)](_0x7e8cc2[_0x38fb72(0xf0)][_0x38fb72(0xfb)]+'@'+(_0x7e8cc2[_0x38fb72(0x1d1)]?'g.us':_0x1e1c61[_0x38fb72(0x151)]),_0x158242),await _0x7e8cc2[_0x38fb72(0x160)](_0x15d3d5);}}const _0x46acbb=_0x3d440f[_0x38fb72(0x130)]?_0x3d440f[_0x38fb72(0x130)][_0x38fb72(0x17e)](/tagId: (\d+)/):null,_0x31c62c=_0x3d440f[_0x38fb72(0x130)]?_0x3d440f['message'][_0x38fb72(0x17e)](/queueId: (\d+)/):null,_0x2670fc=_0x3d440f['message']?_0x3d440f['message']['match'](/status: (\w+)/):null,_0x4b7ee9=_0x3d440f[_0x38fb72(0x130)]?_0x3d440f[_0x38fb72(0x130)][_0x38fb72(0x17e)](/userId: (\d+)/):null,_0x1f3db7=_0x46acbb?_0x1e1c61['UJznU'](parseInt,_0x46acbb[0x1],0xa):null,_0x48b9ba=_0x31c62c?_0x1e1c61[_0x38fb72(0x1d3)](parseInt,_0x31c62c[0x1],0xa):null,_0x8c0c6f=_0x2670fc?_0x2670fc[0x1]:null,_0x1dcc55=_0x4b7ee9?_0x1e1c61[_0x38fb72(0x1e8)](parseInt,_0x4b7ee9[0x1],0xa):null;if(_0x1f3db7){await _0x1e1c61[_0x38fb72(0x1e8)](associateTagToTicket,_0x1f3db7,_0x7e8cc2['id']);const _0x45cc8a={};_0x45cc8a['ticketData']={},_0x45cc8a[_0x38fb72(0x208)]=_0x7e8cc2['id'],_0x45cc8a[_0x38fb72(0x124)]=_0x7e8cc2[_0x38fb72(0x124)],_0x45cc8a['ratingId']=null,await(0x0,UpdateTicketService_1[_0x38fb72(0x10b)])(_0x45cc8a);}if(_0x48b9ba){const _0xa4af2b={};_0xa4af2b[_0x38fb72(0x1d6)]=_0x48b9ba;const _0x49b81c={};_0x49b81c[_0x38fb72(0xf3)]=_0xa4af2b,_0x49b81c[_0x38fb72(0x208)]=_0x7e8cc2['id'],_0x49b81c[_0x38fb72(0x124)]=_0x7e8cc2['companyId'],_0x49b81c[_0x38fb72(0x1a1)]=null,await(0x0,UpdateTicketService_1[_0x38fb72(0x10b)])(_0x49b81c);}if(_0x8c0c6f===_0x1e1c61[_0x38fb72(0xf5)]||_0x1e1c61[_0x38fb72(0x128)](_0x8c0c6f,_0x1e1c61['ZmQYd'])||_0x1e1c61[_0x38fb72(0xf6)](_0x8c0c6f,_0x1e1c61[_0x38fb72(0xea)])){const _0x18bb5b={};_0x18bb5b['status']=_0x8c0c6f;const _0x13c213={};_0x13c213[_0x38fb72(0xf3)]=_0x18bb5b,_0x13c213[_0x38fb72(0x208)]=_0x7e8cc2['id'],_0x13c213[_0x38fb72(0x124)]=_0x7e8cc2[_0x38fb72(0x124)],_0x13c213[_0x38fb72(0x1a1)]=null,await(0x0,UpdateTicketService_1[_0x38fb72(0x10b)])(_0x13c213);}if(_0x1dcc55){const _0x5d02fa={};_0x5d02fa[_0x38fb72(0x177)]=_0x1dcc55,_0x5d02fa[_0x38fb72(0x102)]=_0x38fb72(0x204);const _0x49d4d0={};_0x49d4d0[_0x38fb72(0xf3)]=_0x5d02fa,_0x49d4d0['ticketId']=_0x7e8cc2['id'],_0x49d4d0[_0x38fb72(0x124)]=_0x7e8cc2[_0x38fb72(0x124)],_0x49d4d0[_0x38fb72(0x1a1)]=null,await(0x0,UpdateTicketService_1['default'])(_0x49d4d0);}if(_0x3d440f[_0x38fb72(0x12e)]){const _0x3df7d1=Buffer[_0x38fb72(0x1e9)](_0x3d440f[_0x38fb72(0x12e)],_0x1e1c61[_0x38fb72(0x18d)]);await(0x0,whatsappHelpersService_1[_0x38fb72(0x1f3)])(_0x191328,_0x7e8cc2);const _0x52ec50={};_0x52ec50[_0x38fb72(0x12e)]=_0x3df7d1,await _0x191328['sendMessage'](_0x7e8cc2[_0x38fb72(0xf0)][_0x38fb72(0xfb)]+'@'+(_0x7e8cc2[_0x38fb72(0x1d1)]?_0x38fb72(0x13d):'s.whatsapp.net'),_0x52ec50);}else{if(_0x3d440f[_0x38fb72(0x18a)]){await(0x0,whatsappHelpersService_1['sendTypingStatus'])(_0x191328,_0x7e8cc2);const _0x2b51df={};_0x2b51df[_0x38fb72(0x191)]=_0x3d440f[_0x38fb72(0x18a)];const _0x1f5a96={};_0x1f5a96[_0x38fb72(0x12e)]=_0x2b51df,await _0x191328[_0x38fb72(0x1bb)](_0x7e8cc2['contact'][_0x38fb72(0xfb)]+'@'+(_0x7e8cc2[_0x38fb72(0x1d1)]?_0x1e1c61['BBFDz']:_0x1e1c61[_0x38fb72(0x151)]),_0x1f5a96);}}if(_0x3d440f[_0x38fb72(0x1c3)]){await(0x0,whatsappHelpersService_1[_0x38fb72(0x1f3)])(_0x191328,_0x7e8cc2);const _0x3632c9={};_0x3632c9['url']=_0x3d440f['audioUrl'];const _0x97173a={};_0x97173a['audio']=_0x3632c9,await _0x191328['sendMessage'](_0x7e8cc2[_0x38fb72(0xf0)][_0x38fb72(0xfb)]+'@'+(_0x7e8cc2[_0x38fb72(0x1d1)]?'g.us':_0x1e1c61['kDjWD']),_0x97173a);}if(_0x3d440f[_0x38fb72(0x1ef)]){await(0x0,whatsappHelpersService_1['sendTypingStatus'])(_0x191328,_0x7e8cc2);const _0x13d8de={};_0x13d8de['url']=_0x3d440f[_0x38fb72(0x1ef)];const _0x41d67e={};_0x41d67e[_0x38fb72(0x22d)]=_0x13d8de,await _0x191328[_0x38fb72(0x1bb)](_0x7e8cc2['contact'][_0x38fb72(0xfb)]+'@'+(_0x7e8cc2[_0x38fb72(0x1d1)]?_0x1e1c61[_0x38fb72(0x1b0)]:_0x1e1c61[_0x38fb72(0x151)]),_0x41d67e);}_0x3d440f['waitTime']&&await new Promise(_0xacb6e1=>setTimeout(_0xacb6e1,_0x3d440f[_0x38fb72(0x13a)]*0x3e8));}}}};exports[a796_0x53725a(0x105)]=handleMessageIntegration;function a796_0x333be2(_0x3db703){const _0x4ec4d1=a796_0x53725a,_0x53f74e={'RLQgF':function(_0x29e21b,_0x3982fb){return _0x29e21b===_0x3982fb;},'hjFTJ':'string','LsayV':_0x4ec4d1(0x1db),'BmXIT':_0x4ec4d1(0x147),'NNKrj':function(_0x174c7,_0x739aaf){return _0x174c7+_0x739aaf;},'iTJut':'length','MYqzg':function(_0x33b7e0,_0x4fcd1c){return _0x33b7e0%_0x4fcd1c;},'rkSfs':_0x4ec4d1(0x16c),'ZEyNi':'gger','pvMLT':_0x4ec4d1(0x18b),'vvuJi':function(_0x36d951,_0x49ee1c){return _0x36d951(_0x49ee1c);},'jVxcX':function(_0x11d705,_0x757390){return _0x11d705(_0x757390);}};function _0x2b9609(_0xe2beae){const _0x26eb4b=_0x4ec4d1;if(_0x53f74e['RLQgF'](typeof _0xe2beae,_0x53f74e[_0x26eb4b(0x1d4)]))return function(_0x5e37cd){}[_0x26eb4b(0x1be)](_0x53f74e[_0x26eb4b(0x206)])['apply'](_0x53f74e[_0x26eb4b(0x211)]);else _0x53f74e[_0x26eb4b(0x1ad)]('',_0xe2beae/_0xe2beae)[_0x53f74e[_0x26eb4b(0x14c)]]!==0x1||_0x53f74e[_0x26eb4b(0x1fb)](_0x53f74e['MYqzg'](_0xe2beae,0x14),0x0)?function(){return!![];}[_0x26eb4b(0x1be)](_0x53f74e['NNKrj'](_0x53f74e[_0x26eb4b(0xfd)],_0x53f74e[_0x26eb4b(0x173)]))[_0x26eb4b(0x19b)](_0x26eb4b(0x170)):function(){return![];}['constructor'](_0x53f74e[_0x26eb4b(0x1ad)](_0x53f74e['rkSfs'],_0x26eb4b(0x209)))[_0x26eb4b(0x226)](_0x53f74e[_0x26eb4b(0x23c)]);_0x53f74e[_0x26eb4b(0x232)](_0x2b9609,++_0xe2beae);}try{if(_0x3db703)return _0x2b9609;else _0x53f74e['jVxcX'](_0x2b9609,0x0);}catch(_0x33c229){}}